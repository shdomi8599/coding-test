SELECT 
D.APNT_NO,
D.PT_NAME,
D.PT_NO,
D.MCDP_CD,
C.DR_NAME,
D.APNT_YMD
FROM DOCTOR AS C
INNER JOIN (
SELECT 
B.APNT_NO,
A.PT_NAME,
A.PT_NO,
B.MCDP_CD,
B.APNT_YMD,
B.MDDR_ID
FROM PATIENT AS A
INNER JOIN (
SELECT 
APNT_NO,
APNT_YMD,
PT_NO,
MDDR_ID,
MCDP_CD
FROM APPOINTMENT 
WHERE APNT_YMD LIKE '2022-04-13%' AND APNT_CNCL_YN = 'N'
) AS B
ON A.PT_NO = B.PT_NO
) AS D
ON C.DR_ID = D.MDDR_ID
ORDER BY 6
